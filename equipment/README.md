# 设备管理
## 1. 介绍
### 1.1 EBR系统中设备
- 设备定义:生产制造中的物质资源,如罐/袋/仪器设备
  - 系统中的设备,用于跟踪所有相关的生产活动
- 设备是在生产过程中所使用的一种资源,在使用过程中,可以修改和检查它的状态和特征.
- `属性`:每一件设备都有不同的特点和用途。属性用于定义这些特征
  - 属性用于描述设备。例如，一个属性可以是一个罐的皮重
  - `静态属性`:有些属性在整个生产过程中不会变化,是为静态属性;这些属性用于描述设备的静态物理特性.
    - 如:一个设备有皮重属性,属性值被配置后,该设备被用于生产制造时,这些配置值不会改变.
  - `动态属性`:有些属性用来描述设备随时间的演变.这些属性称为动态属性.
    - 例如，一件设备中的物料数量在不同的生产步骤中会发生变化.
- `接口`:设备上可能连接有PLC等,接口用于表述与设备的数据交互接口
- `类`:对设备进行分类,以便于管理。
  - 一个类具有一组属性,用于表示具有这些属性的一类设备,即属于该类的设备具有该类的所有属性.
  - 一个类也可以具有一组接口,即属于该类的设备具有该类的所有接口
- 设备在配置之后才可以在生产中使用
- 库存管理中的容器(最小存储单元),可以直接连接到设备.
  - 容器按照批次分组管理,容器信息中包含物料的状态信息.

### 1.2 属性与类的生命周期
- 属性和类的生命周期: ![pic](/pics/设备管理_属性和类的生命周期.png)

### 1.3 EBR设备管理的主要功能
- 设备管理主要有以下功能
  - 设备列表
  - 设备属性
  - 设备类别
  - 属性配置
  - 接口配置

## 2. 属性列表
### 2.1 介绍
- 属性用于定义和描述设备
- 系统内置了一些标准属性
- 属性可以提供关于设备特性的信息,这些特性不会随时间变化;这样的属性称为"静态属性"，可以在配置中修改它
  - 如:容器的皮重或仪表的最大测量值
- 属性也可以提供关于随时间变化的特征的信息;这样的属性称为"动态属性"。
  - 如:容器的毛重,仪表的校准状态
- 属性分为不同类型:文本,数字,列表,状态
- 属性信息
  - 常规信息:编码,名称,类型,状态
  - 类型特定信息
    - 文本:最大长度
    - 数字:是否需要单位,是否需要最大,最小值
    - 列表:是否可包含称量标签,是否可包含容器,是否可包含设备,是否可包含其他(除称量标签,容器,设备之外的)信息
    - 状态:值列表,转换列表
- 属性更新后,使用属性的类别和设备配置也需要更新.
### 2.1 界面说明
- 主界面:![pic](/pics/设备管理_属性列表.png)
- 属性维护:![pic](/pics/设备管理_属性维护.png)

### 2.2 字段说明
- 编码:必填,设备编码;长度限制为 1-32;其他约束满足系统 code 的统一约束
- 名称:必填,长度限制1-250.
- 类别:必填
### 2.2 操作说明
#### 2.2.1 排序筛选
- 主界面
  - 排序
    - 默认排序: 按照编码升序
    - 字段范围: 编码,名称,类型,是否标准属性,状态
  - 筛选
    - 默认筛选: 不显示失效的属性
    - 字段范围: 编码,名称,类型,是否标准属性,状态
    - 支持扫码查询
#### 2.2.2 新增
- 状态:新增后,属性状态为`已创建`,不可编辑
- 类型:从列表选择要创建的属性类型.不同类型有不同要求,如下
  - 文本:无默认值,必须指定最大长度,值范围[1,250]
  - 数字:可勾选以下项:是否需要单位,是否需要最大,最小值; 均为选填,可多选.
  - 列表:至少勾选一项:是否可包含称量标签,是否可包含容器,是否可包含设备,是否可包含其他(除称量标签,容器,设备之外的)
  - 状态:可以维护状态值列表和转换列表;且至少添加一个状态值;
    - 状态列表-锁定:
  - 各类型特有的信息,只有选择对应类型后才可填写.
- 新创建的属性均为非标准属性,该项不可编辑.
#### 2.2.3 编辑
- 除编码与类型不可编辑外,其他与新增相同.
#### 2.2.4 失效/激活
- TODO:周五从此处开始,原型图:状态属性-值编辑/状态装换编辑
- 生效:激活设备,修改设备状态到"可编辑"
- 失效:删除设备,修改设备状态到"失效的"
- 失效的设备,只允许[查看]明细,[复制]和[激活]
#### 2.2.1 明细
- 明细查看:查看指定设备的属性配置信息;查看方式如下:
  - 双击指定设备, 以只读方式显示设备配置明细
  - 指定设备,点击【查看】按钮,以只读方式显示设备配置明细
#### 2.2.1 复制
- 快速创建配置的功能,复制除编码之外的信息.
#### 2.2.1 刷新
- 获取服务端最新数据
---
## 4. 属性配置
### 4.1 介绍
- 属性配置:属性从类别继承而来,该配置主要是给属性赋值
- 属性的信息
  - 编码
  - 名称
  - 类别
  - 一致性
  - 状态
  - 静态属性(来自类别)
  - 动态属性(来自类别)
### 4.1 界面说明
- 主界面: ![pic](/pics/设备管理_属性配置.png)
- 编辑: ![pic](/pics/设备管理_属性配置_编辑.png)
- 
### 4.2 字段说明
- 编码:必填,设备编码;长度限制为 1-32;其他约束满足系统 code 的统一约束
- 名称:必填,长度限制1-250.
- 类别:必填
### 4.3 操作说明
#### 4.3.1 排序筛选
- 主界面
  - 排序
    - 默认排序: 按照编码升序
    - 字段范围: 编码,名称,类别,一致性,状态
  - 筛选
    - 默认筛选: 不显示失效的设备
    - 字段范围: 编码,名称,类别,一致性,状态
    - 支持扫码查询
#### 4.3.2 新增
- 状态:新增后,属性状态为`已创建`,不可编辑
- 可编辑的信息有
  - 类别:可从新选择类别编码,但是失效的类别,不能在新增时使用.
    - 选择新类别后,静态属性和动态属性会按照新类别重设
  - 名称
  - 静态属性:值可编辑,其他均使用类别的信息
    - 指定要编辑的静态属性,进行编辑.注意,不同类型的属性,其维护界面不同
- 不可编辑的信息有
  - 状态
  - 一致性:使用类别的一致性,不可编辑
  - 动态属性:不可编辑,均使用类别的信息
- 属性配置创建完成后,会自动创建用于生产的设备
  - 该设备的属性就是刚才配置的属性
  - TODO: 4.2.2  
#### 4.3.3 编辑
- 除编码不可编辑外,其他与新增相同.
#### 4.3.4 失效/激活
- 生效:激活设备,修改设备状态到"可编辑"
- 失效:删除设备,修改设备状态到"失效的"
- 失效的设备,只允许[查看]明细,[复制]和[激活]
#### 4.3.5 明细
- 明细查看:查看指定设备的属性配置信息;查看方式如下:
  - 双击指定设备, 以只读方式显示设备配置明细
  - 指定设备,点击【查看】按钮,以只读方式显示设备配置明细
#### 4.3.6 复制
- 快速创建配置的功能,复制除编码之外的信息.
#### 4.3.7 刷新
- 获取服务端最新数据

